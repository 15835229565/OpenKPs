KpWorkflow
=============================

Драйвер KpWorkflow.dll является прикладной библиотекой для приложения Scada Communicator проекта RapidScada.  
Этот драйвер позволяет реализовать управление последовательностью выполнения задач внутри рабочего потока (workflow). При реализации данного проекта использовались следующие библиотеки:  
	- [Wexflow ](https://github.com/aelassas/Wexflow/)  
	- [Mathparser](https://github.com/mariuszgromada/MathParser.org-mXparser)  
	
Вводная информация о работе драйвера KpWorkflow.
--------------------------------------------------------------------------------

Для понимания работы драйвера необходимо дать определение трем основным сущностям, определяющим его работу.  
**Рабочий поток** - это структура описывающая задачи и последовательность их исполнения. Если последовательность исполнения не задана, то задачи описанные внутри рабочего потока выполняются последовательно.  
**Задача** - это некоторый обобщенный алгоритм, для которого могут быть заданы входные и выходные параметры. В базовом виде механизм обмена данными между задачами осуществляется через файлы. В драйвере KpWorkflow добавлен механизм обмена данными через дополнительные объекты в памяти. Этот механизм используется в задачах для которых важна скорость выполнения.  
**Граф выполнения** - это структура, которая описывает последовательность выполнения задач. При описании последовательности выполнения задач могут использоваться конструкции, реализующие условные операторы **if-else**, операторы выбора **switch-case**, оператор цикла **while**, а также реакция на события задач **OnSuccess**, **OnWarning**, **OnError**.  

Примеры построения рабочих потоков.
---------------------------------------------------

При построении рабочих потоков, необходимо ознакомиться с описанием типовых задач. У каждой задачи такое описание содержится в xml файле, совпадающем с именем задачи. В этом файле дается детальное описание используемых параметров задачи при ее конфигурировании.  
Структура файла рабочего потока состоит из 4-х разделов:  
- Корневой раздел - в этом разделе находится описание потока и его идетнификационный номер.
- Заголовочный раздел - в этом разделе находится описание потока и параметры.  
- Раздел описания задач - содержит список задач и их параметры конфигурации.  
- Раздел описания графа исполнения задач - этот раздел содержит описание потокового алгоритма выполнения задач. Если данный раздел отсутствует, то задачи выполняются последовательно.  

Создадим рабочий поток, который ничего полезного не делает, но показывает базовые принципы его построения и конфигурирования.  
Ниже показан пример такого рабочего потока:  

```xml
<Workflow xmlns="urn:wexflow-schema" id="41" name="Workflow_Wait" description="Workflow_Wait">
	<Settings>
		<Setting name="launchType" value="periodic" /> <!-- startup|trigger|periodic -->
		<Setting name="period" value="00.00:00:10.00" />
		<Setting name="enabled" value="true" /> <!-- true|false -->
		<Setting name="createTF" value="false"/> <!-- true|false -->
	</Settings>
	<Tasks>
		<Task id="1" name="Wait" description="Wait for 5 seconds..." enabled="true">
			<Setting name="duration" value="00.00:00:05" />
		</Task>
	</Tasks>
</Workflow>
```
В этом примере рабочий поток запускается каждые 10 секунд. Задача внутри рабочего потока останавливает его выполнение на 5 секунд при каждом запуске.
Структура файла рабочего потока состоит из корневого раздела **Workflow**, заголовочного раздела **Settings** и раздела описания задач **Tasks** .
Корневой раздел **Workflow** содержит три параметра:  
- **id** - определяет уникальный номер рабочего процесса в пределах одного КП. Данный номер используется для управления рабочим потоком по команде из Rapid Scada. В текущем примере данная функциональность не используется, поскольку задействован другой тип запуска рабочего потока.  
- **name** - короткое имя рабочего потока, используется в подсистеме логирования.  
- **description** - в этом параметре можно более детально описать назначение рабочего потока.  
Заголовочный раздел **Settings** содержит четыре параметра:



Настройка KpWorkflow драйвера для Scada Communicator.
------------------------------------------------------------------------





